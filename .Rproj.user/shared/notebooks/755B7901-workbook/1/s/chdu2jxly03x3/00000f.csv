"0","states_coord$fav_make <- factor(states_coord$fav_make)"
"0","# Got help from https://www.analytics-tuts.com/color-usa-map-based-on-a-categorical-variable-using-plotly-in-r/"
"0","states_coord$fav_make_val <- factor(as.numeric(states_coord$fav_make))"
"0",""
"0","states_coord$hover_text <- with(states_coord, "
"0","                                paste(""<b>State:</b>"", state_name, '<br>', "
"0","                                      ""<b>Number of Listings:</b>"", num_listings,""<br>"","
"0","                                      ""<b>Mean Price ($):</b>"", mean_price, ""<br>"","
"0","                                      ""<b>Favorite Make:</b>"", fav_make))"
"0",""
"0","# specify some map projection/options"
"0","g <- list("
"0","    scope = 'usa',"
"0","    projection = list(type = 'albers usa'),"
"0","    showocean = TRUE,"
"0","    oceancolor = toRGB(""grey""),"
"0","    showlakes = TRUE,"
"0","    lakecolor = toRGB(""LightBlue""),"
"0","    showrivers = TRUE,"
"0","    rivercolor = toRGB(""LightBlue"")"
"0",")"
"0",""
"0","# Setting up colors for fav makes"
"0","nfactor <- length(levels(states_coord$fav_make_val))"
"0","#colr <- brewer.pal(n = nfactor,name = ""RdYlGn"")"
"0","#colr <- c(""#8B4500"", ""#FFB90F"", ""#6495ED"", ""#458B74"", ""#838B8B"", ""#7A378B"")"
"0","colr <- c(""#8B6914"", ""#FFEC8B"", ""#63B8FF"", ""#76EEC6"", ""#C1CDCD"", ""#AB82FF"")"
"0",""
"0","names(colr) <- levels(states_coord$fav_make)"
"0",""
"0","colrS <- function(n){"
"0","    CUTS <- seq(0,1,length.out=n+1)"
"0","    print(CUTS)"
"0","    rep(CUTS,ifelse(CUTS %in% 0:1,1,2))"
"0","}"
"0",""
"0","colorScale <- data.frame(z=colrS(nfactor), "
"0","                         col=rep(colr,each=2),"
"0","                         stringsAsFactors=FALSE)"
"1","[1]"
"1"," 0.0000000"
"1"," 0.1666667"
"1"," 0.3333333"
"1"," 0.5000000"
"1"," 0.6666667"
"1"," 0.8333333"
"1"," 1.0000000"
"1","
"
"0","p <- plot_ly(data = states_coord, "
"0","             type = ""choropleth"","
"0","             locations = ~state_code, "
"0","             locationmode = ""USA-states"", "
"0","             z = ~fav_make_val, "
"0","             text = ~hover_text,"
"0","             colorscale = colorScale, "
"0","             colorbar = list(tickvals=1:nfactor, "
"0","                             ticktext=names(colr),"
"0","                             title = ""Favorate Make"") ) %>%"
"0","layout(title = '2018 US Used Cars -- Favorite Make by State "
"0","       <br>(Hover for more details about listings)',"
"0","       geo = g) "
"0",""
"0","ggplotly(p)"
"2","Warning:"
"2"," `marker.color` does not currently support multiple values.
"
"2","Warning:"
"2"," `marker.color` does not currently support multiple values.
"
