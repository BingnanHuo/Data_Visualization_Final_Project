<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
  <title>MATH230 Final Project: Confidence Level Project</title>



  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2022-04-07"/>
  <meta property="article:created" itemprop="dateCreated" content="2022-04-07"/>
  <meta name="article:author" content="Shishir Katta, Nick Huo, Yida Chen"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="MATH230 Final Project: Confidence Level Project"/>
  <meta property="og:type" content="article"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:site_name" content="MATH230 Final Project"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="MATH230 Final Project: Confidence Level Project"/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Confidence Level Project"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Shishir Katta, Nick Huo, Yida Chen"]}]}]},{"type":"character","attributes":{},"value":["2022-04-07"]},{"type":"character","attributes":{},"value":["pdf_document"]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  <!--radix_placeholder_navigation_in_header-->
  <meta name="distill:offset" content=""/>

  <script type="application/javascript">

    window.headroom_prevent_pin = false;

    window.document.addEventListener("DOMContentLoaded", function (event) {

      // initialize headroom for banner
      var header = $('header').get(0);
      var headerHeight = header.offsetHeight;
      var headroom = new Headroom(header, {
        tolerance: 5,
        onPin : function() {
          if (window.headroom_prevent_pin) {
            window.headroom_prevent_pin = false;
            headroom.unpin();
          }
        }
      });
      headroom.init();
      if(window.location.hash)
        headroom.unpin();
      $(header).addClass('headroom--transition');

      // offset scroll location for banner on hash change
      // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
      window.addEventListener("hashchange", function(event) {
        window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
      });

      // responsive menu
      $('.distill-site-header').each(function(i, val) {
        var topnav = $(this);
        var toggle = topnav.find('.nav-toggle');
        toggle.on('click', function() {
          topnav.toggleClass('responsive');
        });
      });

      // nav dropdowns
      $('.nav-dropbtn').click(function(e) {
        $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
        $(this).parent().siblings('.nav-dropdown')
           .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $("body").click(function(e){
        $('.nav-dropdown-content').removeClass('nav-dropdown-active');
      });
      $(".nav-dropdown").click(function(e){
        e.stopPropagation();
      });
    });
  </script>

  <style type="text/css">

  /* Theme (user-documented overrideables for nav appearance) */

  .distill-site-nav {
    color: rgba(255, 255, 255, 0.8);
    background-color: #0F2E3D;
    font-size: 15px;
    font-weight: 300;
  }

  .distill-site-nav a {
    color: inherit;
    text-decoration: none;
  }

  .distill-site-nav a:hover {
    color: white;
  }

  @media print {
    .distill-site-nav {
      display: none;
    }
  }

  .distill-site-header {

  }

  .distill-site-footer {

  }


  /* Site Header */

  .distill-site-header {
    width: 100%;
    box-sizing: border-box;
    z-index: 3;
  }

  .distill-site-header .nav-left {
    display: inline-block;
    margin-left: 8px;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header .nav-left {
      margin-left: 0;
    }
  }


  .distill-site-header .nav-right {
    float: right;
    margin-right: 8px;
  }

  .distill-site-header a,
  .distill-site-header .title {
    display: inline-block;
    text-align: center;
    padding: 14px 10px 14px 10px;
  }

  .distill-site-header .title {
    font-size: 18px;
    min-width: 150px;
  }

  .distill-site-header .logo {
    padding: 0;
  }

  .distill-site-header .logo img {
    display: none;
    max-height: 20px;
    width: auto;
    margin-bottom: -4px;
  }

  .distill-site-header .nav-image img {
    max-height: 18px;
    width: auto;
    display: inline-block;
    margin-bottom: -3px;
  }



  @media screen and (min-width: 1000px) {
    .distill-site-header .logo img {
      display: inline-block;
    }
    .distill-site-header .nav-left {
      margin-left: 20px;
    }
    .distill-site-header .nav-right {
      margin-right: 20px;
    }
    .distill-site-header .title {
      padding-left: 12px;
    }
  }


  .distill-site-header .nav-toggle {
    display: none;
  }

  .nav-dropdown {
    display: inline-block;
    position: relative;
  }

  .nav-dropdown .nav-dropbtn {
    border: none;
    outline: none;
    color: rgba(255, 255, 255, 0.8);
    padding: 16px 10px;
    background-color: transparent;
    font-family: inherit;
    font-size: inherit;
    font-weight: inherit;
    margin: 0;
    margin-top: 1px;
    z-index: 2;
  }

  .nav-dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 200px;
    border: 1px solid rgba(0,0,0,0.15);
    border-radius: 4px;
    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
    z-index: 1;
    margin-top: 2px;
    white-space: nowrap;
    padding-top: 4px;
    padding-bottom: 4px;
  }

  .nav-dropdown-content hr {
    margin-top: 4px;
    margin-bottom: 4px;
    border: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .nav-dropdown-active {
    display: block;
  }

  .nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
    color: black;
    padding: 6px 24px;
    text-decoration: none;
    display: block;
    text-align: left;
  }

  .nav-dropdown-content .nav-dropdown-header {
    display: block;
    padding: 5px 24px;
    padding-bottom: 0;
    text-transform: uppercase;
    font-size: 14px;
    color: #999999;
    white-space: nowrap;
  }

  .nav-dropdown:hover .nav-dropbtn {
    color: white;
  }

  .nav-dropdown-content a:hover {
    background-color: #ddd;
    color: black;
  }

  .nav-right .nav-dropdown-content {
    margin-left: -45%;
    right: 0;
  }

  @media screen and (max-width: 768px) {
    .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
    .distill-site-header a.nav-toggle {
      float: right;
      display: block;
    }
    .distill-site-header .title {
      margin-left: 0;
    }
    .distill-site-header .nav-right {
      margin-right: 0;
    }
    .distill-site-header {
      overflow: hidden;
    }
    .nav-right .nav-dropdown-content {
      margin-left: 0;
    }
  }


  @media screen and (max-width: 768px) {
    .distill-site-header.responsive {position: relative; min-height: 500px; }
    .distill-site-header.responsive a.nav-toggle {
      position: absolute;
      right: 0;
      top: 0;
    }
    .distill-site-header.responsive a,
    .distill-site-header.responsive .nav-dropdown {
      display: block;
      text-align: left;
    }
    .distill-site-header.responsive .nav-left,
    .distill-site-header.responsive .nav-right {
      width: 100%;
    }
    .distill-site-header.responsive .nav-dropdown {float: none;}
    .distill-site-header.responsive .nav-dropdown-content {position: relative;}
    .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
      display: block;
      width: 100%;
      text-align: left;
    }
  }

  /* Site Footer */

  .distill-site-footer {
    width: 100%;
    overflow: hidden;
    box-sizing: border-box;
    z-index: 3;
    margin-top: 30px;
    padding-top: 30px;
    padding-bottom: 30px;
    text-align: center;
  }

  /* Headroom */

  d-title {
    padding-top: 6rem;
  }

  @media print {
    d-title {
      padding-top: 4rem;
    }
  }

  .headroom {
    z-index: 1000;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
  }

  .headroom--transition {
    transition: all .4s ease-in-out;
  }

  .headroom--unpinned {
    top: -100px;
  }

  .headroom--pinned {
    top: 0;
  }

  /* adjust viewport for navbar height */
  /* helps vertically center bootstrap (non-distill) content */
  .min-vh-100 {
    min-height: calc(100vh - 100px) !important;
  }

  </style>

  <script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
  <link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
  <script src="site_libs/headroom-0.9.4/headroom.min.js"></script>
  <script src="site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
  <script src="site_libs/fuse-6.4.1/fuse.min.js"></script>

  <script type="application/javascript">

  function getMeta(metaName) {
    var metas = document.getElementsByTagName('meta');
    for (let i = 0; i < metas.length; i++) {
      if (metas[i].getAttribute('name') === metaName) {
        return metas[i].getAttribute('content');
      }
    }
    return '';
  }

  function offsetURL(url) {
    var offset = getMeta('distill:offset');
    return offset ? offset + '/' + url : url;
  }

  function createFuseIndex() {

    // create fuse index
    var options = {
      keys: [
        { name: 'title', weight: 20 },
        { name: 'categories', weight: 15 },
        { name: 'description', weight: 10 },
        { name: 'contents', weight: 5 },
      ],
      ignoreLocation: true,
      threshold: 0
    };
    var fuse = new window.Fuse([], options);

    // fetch the main search.json
    return fetch(offsetURL('search.json'))
      .then(function(response) {
        if (response.status == 200) {
          return response.json().then(function(json) {
            // index main articles
            json.articles.forEach(function(article) {
              fuse.add(article);
            });
            // download collections and index their articles
            return Promise.all(json.collections.map(function(collection) {
              return fetch(offsetURL(collection)).then(function(response) {
                if (response.status === 200) {
                  return response.json().then(function(articles) {
                    articles.forEach(function(article) {
                      fuse.add(article);
                    });
                  })
                } else {
                  return Promise.reject(
                    new Error('Unexpected status from search index request: ' +
                              response.status)
                  );
                }
              });
            })).then(function() {
              return fuse;
            });
          });

        } else {
          return Promise.reject(
            new Error('Unexpected status from search index request: ' +
                        response.status)
          );
        }
      });
  }

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // get search element (bail if we don't have one)
    var searchEl = window.document.getElementById('distill-search');
    if (!searchEl)
      return;

    createFuseIndex()
      .then(function(fuse) {

        // make search box visible
        searchEl.classList.remove('hidden');

        // initialize autocomplete
        var options = {
          autoselect: true,
          hint: false,
          minLength: 2,
        };
        window.autocomplete(searchEl, options, [{
          source: function(query, callback) {
            const searchOptions = {
              isCaseSensitive: false,
              shouldSort: true,
              minMatchCharLength: 2,
              limit: 10,
            };
            var results = fuse.search(query, searchOptions);
            callback(results
              .map(function(result) { return result.item; })
            );
          },
          templates: {
            suggestion: function(suggestion) {
              var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
                ? `<img src="${offsetURL(suggestion.preview)}"</img>`
                : '';
              var html = `
                <div class="search-item">
                  <h3>${suggestion.title}</h3>
                  <div class="search-item-description">
                    ${suggestion.description || ''}
                  </div>
                  <div class="search-item-preview">
                    ${img}
                  </div>
                </div>
              `;
              return html;
            }
          }
        }]).on('autocomplete:selected', function(event, suggestion) {
          window.location.href = offsetURL(suggestion.path);
        });
        // remove inline display style on autocompleter (we want to
        // manage responsive display via css)
        $('.algolia-autocomplete').css("display", "");
      })
      .catch(function(error) {
        console.log(error);
      });

  });

  </script>

  <style type="text/css">

  .nav-search {
    font-size: x-small;
  }

  /* Algolioa Autocomplete */

  .algolia-autocomplete {
    display: inline-block;
    margin-left: 10px;
    vertical-align: sub;
    background-color: white;
    color: black;
    padding: 6px;
    padding-top: 8px;
    padding-bottom: 0;
    border-radius: 6px;
    border: 1px #0F2E3D solid;
    width: 180px;
  }


  @media screen and (max-width: 768px) {
    .distill-site-nav .algolia-autocomplete {
      display: none;
      visibility: hidden;
    }
    .distill-site-nav.responsive .algolia-autocomplete {
      display: inline-block;
      visibility: visible;
    }
    .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
      margin-left: 0;
      width: 400px;
      max-height: 400px;
    }
  }

  .algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
    width: 90%;
    outline: none;
    border: none;
  }

  .algolia-autocomplete .aa-hint {
    color: #999;
  }
  .algolia-autocomplete .aa-dropdown-menu {
    width: 550px;
    max-height: 70vh;
    overflow-x: visible;
    overflow-y: scroll;
    padding: 5px;
    margin-top: 3px;
    margin-left: -150px;
    background-color: #fff;
    border-radius: 5px;
    border: 1px solid #999;
    border-top: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
    cursor: pointer;
    padding: 5px 4px;
    border-bottom: 1px solid #eee;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
    border-bottom: none;
    margin-bottom: 2px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
    overflow: hidden;
    font-size: 0.8em;
    line-height: 1.4em;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
    font-size: 1rem;
    margin-block-start: 0;
    margin-block-end: 5px;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
    display: inline-block;
    overflow: hidden;
    height: 2.8em;
    width: 80%;
    margin-right: 4%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
    display: inline-block;
    width: 15%;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
    height: 3em;
    width: auto;
    display: none;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
    display: initial;
  }

  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
    background-color: #eee;
  }
  .algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
    font-weight: bold;
    font-style: normal;
  }

  </style>


  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: auto;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  d-article details {
    grid-column: text;
    margin-bottom: 0.8em;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }

  /* Citation hover box */

  .tippy-box[data-theme~=light-border] {
    background-color: rgba(250, 250, 250, 0.95);
  }

  .tippy-content > p {
    margin-bottom: 0;
    padding: 2px;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }

  /* Styles for listing layout (hide title) */
  .layout-listing d-title, .layout-listing .d-title {
    display: none;
  }

  /* Styles for posts lists (not auto-injected) */


  .posts-with-sidebar {
    padding-left: 45px;
    padding-right: 45px;
  }

  .posts-list .description h2,
  .posts-list .description p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  }

  .posts-list .description h2 {
    font-weight: 700;
    border-bottom: none;
    padding-bottom: 0;
  }

  .posts-list h2.post-tag {
    border-bottom: 1px solid rgba(0, 0, 0, 0.2);
    padding-bottom: 12px;
  }
  .posts-list {
    margin-top: 60px;
    margin-bottom: 24px;
  }

  .posts-list .post-preview {
    text-decoration: none;
    overflow: hidden;
    display: block;
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    padding: 24px 0;
  }

  .post-preview-last {
    border-bottom: none !important;
  }

  .posts-list .posts-list-caption {
    grid-column: screen;
    font-weight: 400;
  }

  .posts-list .post-preview h2 {
    margin: 0 0 6px 0;
    line-height: 1.2em;
    font-style: normal;
    font-size: 24px;
  }

  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.4em;
    font-size: 16px;
  }

  .posts-list .post-preview .thumbnail {
    box-sizing: border-box;
    margin-bottom: 24px;
    position: relative;
    max-width: 500px;
  }
  .posts-list .post-preview img {
    width: 100%;
    display: block;
  }

  .posts-list .metadata {
    font-size: 12px;
    line-height: 1.4em;
    margin-bottom: 18px;
  }

  .posts-list .metadata > * {
    display: inline-block;
  }

  .posts-list .metadata .publishedDate {
    margin-right: 2em;
  }

  .posts-list .metadata .dt-authors {
    display: block;
    margin-top: 0.3em;
    margin-right: 2em;
  }

  .posts-list .dt-tags {
    display: block;
    line-height: 1em;
  }

  .posts-list .dt-tags .dt-tag {
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0.3em 0.4em;
    margin-right: 0.2em;
    margin-bottom: 0.4em;
    font-size: 60%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  .posts-list img {
    opacity: 1;
  }

  .posts-list img[data-src] {
    opacity: 0;
  }

  .posts-more {
    clear: both;
  }


  .posts-sidebar {
    font-size: 16px;
  }

  .posts-sidebar h3 {
    font-size: 16px;
    margin-top: 0;
    margin-bottom: 0.5em;
    font-weight: 400;
    text-transform: uppercase;
  }

  .sidebar-section {
    margin-bottom: 30px;
  }

  .categories ul {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }

  .categories li {
    color: rgba(0, 0, 0, 0.8);
    margin-bottom: 0;
  }

  .categories li>a {
    border-bottom: none;
  }

  .categories li>a:hover {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  }

  .categories .active {
    font-weight: 600;
  }

  .categories .category-count {
    color: rgba(0, 0, 0, 0.4);
  }


  @media(min-width: 768px) {
    .posts-list .post-preview h2 {
      font-size: 26px;
    }
    .posts-list .post-preview .thumbnail {
      float: right;
      width: 30%;
      margin-bottom: 0;
    }
    .posts-list .post-preview .description {
      float: left;
      width: 45%;
    }
    .posts-list .post-preview .metadata {
      float: left;
      width: 20%;
      margin-top: 8px;
    }
    .posts-list .post-preview p {
      margin: 0 0 12px 0;
      line-height: 1.5em;
      font-size: 16px;
    }
    .posts-with-sidebar .posts-list {
      float: left;
      width: 75%;
    }
    .posts-with-sidebar .posts-sidebar {
      float: right;
      width: 20%;
      margin-top: 60px;
      padding-top: 24px;
      padding-bottom: 24px;
    }
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  .downlevel .posts-list .post-preview {
    color: inherit;
  }



  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('details, div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // hoverable references
      $('span.citation[data-cites]').each(function() {
        var refs = $(this).attr('data-cites').split(" ");
        var refHtml = refs.map(function(ref) {
          return "<p>" + $('#ref-' + ref).html() + "</p>";
        }).join("\n");
        window.tippy(this, {
          allowHTML: true,
          content: refHtml,
          maxWidth: 500,
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        });
      });

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
  <script src="site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Confidence Level Project","authors":[{"author":"Shishir Katta, Nick Huo, Yida Chen","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-04-07T00:00:00.000-04:00","citationText":"Chen, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="index.html" class="title">MATH230 Final Project</a>
</div>
<div class="nav-right">
<a href="index.html">Homepage</a>
<a href="course_visualizations.html">Course Visualizations</a>
<a href="data_story.html">Data Story</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Confidence Level Project</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->

</div>

<div class="d-byline">
  
  Shishir Katta, Nick Huo, Yida Chen
  
<br/>2022-04-07
</div>

<div class="d-article">
<h2 id="install-all-libraries">Install all libraries</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'>#install.packages("ggplot2")</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="welcome-to-our-introduction-of-confidence-level">1 Welcome to
our introduction of Confidence Level!<br />
</h2>
<p>In this project, we will cover the concepts of repeated sampling,
confidence levels and intervals. We will introduce the concepts through
both the texts and visualizations.</p>
<p>Before reaching these goals, we need to review several key concepts
that are fundamental for the study of confidence levels.</p>
<h3 id="sampling-distribution">1.1 Sampling Distribution</h3>
<p>The sampling distribution is the probability distribution of a
statistic (e.g. mean) calculated from different experiments. Each
experiment will randomly draw a number of samples from the population.
All data of the population have the same probability of being chosen by
the experiment.</p>
<h3 id="central-limit-theorem">1.2 Central Limit Theorem</h3>
<p>Why is sampling distribution important? According to the Central
Limit Theorem (CLT), if we have random samples, <span
class="math inline">\(X_1, \ X_2, \dots, X_n\)</span>, from a population
with mean <span class="math inline">\(\mu\)</span> and standard
deviation <span class="math inline">\(\sigma\)</span>, and if the sample
size <span class="math inline">\(n\)</span> is sufficiently large, then
the distribution of the sample mean <span
class="math inline">\(\bar{x}\)</span> is approximately normal with mean
<span class="math inline">\(\mu\)</span> and standard deviation <span
class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>.</p>
<p><span class="math display">\[\bar{X} \approx \mathcal{N}\left(\mu,
\frac{\sigma}{\sqrt{n}}\right)\]</span></p>
<p>This is true regardless the shape of the population distribution. In
other words, the shape of sampling distribution of <span
class="math inline">\(\bar{X}\)</span> will be approximately normal (for
large sample size <span class="math inline">\(n\)</span>) even if the
population distribution is not.</p>
<h2 id="what-are-the-confidence-level-and-confidence-interval">2. What
are the confidence level and confidence interval?</h2>
<p>After this quick review of the sampling distribution and CLT, we now
can start our exploration of confidence level and interval.</p>
<p>What are the confidence level and interval? In simple words, the
confidence level represents the proportion of the time that its
associated interval calculated from samples will capture the true
parameters, namely, the success rate. For example with a 90% confidence
interval for the mean, you would expect the intervals calculated from
the 90% of experiments with <span class="math inline">\(n\)</span>
random samples will cover the true population mean.</p>
<p>A confidence interval is useful when we want to find a possible range
of a population parameter but only a sample of the population is
available. We use the sampled observations, which may be a good
approximation of population distribution, to estimate a possible range
for the true parameter.</p>
<p>The population parameter (e.g. mean or median) is a fixed value, but
the sample statistic is a random variable because we are uncertain about
its value before obtaining the samples. Thus, the intervals calculated
with sample statistics may or may not contain the true parameter. The
intervals’ long-run success rate of capturing true parameters is
determined by their confidence level.</p>
<h2 id="understanding-intervals">3. Understanding intervals</h2>
<p>The confidence interval is a range of possible values for a
population parameter. It is calculated from a set of samples. For a
confidence interval of mean, the interval uses the sample mean as the
center and two equal-length sides, <span class="math inline">\(\mu\
\pm\)</span> Margin of Error.</p>
<p>To calculate the confidence interval, we need several measurements of
samples and some information about the population:</p>
<ol type="1">
<li>The sample mean <span class="math inline">\(\mu\)</span></li>
<li>The sample size <span class="math inline">\(n\)</span></li>
<li>Whether the population distribution is normal</li>
<li>If so, what is the standard deviation of the population</li>
<li>Finally, what is the confidence level for the interval</li>
</ol>
<p>After learning all the information above, we can calculate the
confidence interval using the formula below:</p>
<p><span class="math display">\[\mu\ \pm\ Z_{\alpha/2}\ \times
\frac{\sigma}{\sqrt{n}}\]</span></p>
<p>The <span class="math inline">\(Z_{\alpha/2}\)</span> is the critical
value of normal distribution. The alpha level <span
class="math inline">\(\alpha\)</span> can be calculated by <span
class="math inline">\((100 - c) / 100\)</span> where <span
class="math inline">\(c\ \%\)</span> is the confidence level of the
interval. The critical value <span
class="math inline">\(Z_{\alpha/2}\)</span> is the value of standard
normal distribution, <span class="math inline">\(Z \sim \mathcal{N}(0,
1)\)</span>, where <span class="math inline">\(P(Z \geq Z_{\alpha/2}) =
(1 - confidence\ level) / 2\)</span>.</p>
<p>As shown in this formula, the location of an interval may vary as the
sample means can be different among experiments. Furthermore, the width
of the interval (margin of error) is affected by three factors: (1) the
sample size, (2) the standard deviation of the population, and (3) and
the confidence level.</p>
<p>The interval will shrink if we have a larger sample size as our
sample distribution is more likely to represent the true distribution.
Similarly, if the population has a small variance (small standard
deviation <span class="math inline">\(\sigma\)</span>), then our sample
statistic is also more likely to capture the true parameter. Thus, we
will have a smaller interval for a smaller population standard deviation
<span class="math inline">\(\sigma\)</span>. Finally, if we have a lower
confidence level (smaller <span
class="math inline">\(Z_{\alpha/2}\)</span>), the interval will become
narrower since we expect fewer intervals to cover the true parameter in
the long run.</p>
<p>Vice Versa, we will have a wider confidence interval for a smaller
sample size <span class="math inline">\(n\)</span>, a larger population
standard deviation <span class="math inline">\(\sigma\)</span>, or a
higher confidence level (smaller alpha level and larger <span
class="math inline">\(Z_{\alpha/2}\)</span>).</p>
<h2
id="confidence-interval-a-practical-estimation-of-population-parameter">4.
Confidence Interval: A practical estimation of population parameter</h2>
<p>Why is confidence interval so important? Let’s assume we want to
figure out the average height of a male adult living in France with ages
between 25 and 50. One way to do this is to send a survey to all French
male adults. However, we will find it is impossible or at least
impractical to conduct this survey. We may not find every French male
adult, and not everyone is interested in filling our survey. Instead, we
can distribute our survey to a small group of people at a shopping mall
in Paris. If our sample size is large enough (like a few hundred), then
we can make a good estimate of the average French male height using the
confidence interval calculated from our sampled observations.</p>
<p>In most cases, measuring a confidence interval from a sample is much
more cost-effective and practical compared with measuring the population
parameter.</p>
<h2
id="repeated-sampling-from-a-normal-distribution-and-confidence-interval-visualizations">5.
Repeated Sampling from a Normal Distribution and Confidence Interval
Visualizations</h2>
<p>To study the confidence interval, we will conduct the repeated
sampling from a normal distribution with mean of 0 and standard
deviation, <span class="math inline">\(Z \sim \mathcal{N}\left(0, \
1\right)\)</span> with sample size <span
class="math inline">\(n=50\)</span>. We plan to repeat the sampling
10000 times and calculate the 95%, 90%, and 80% confidence intervals for
each experiment. Several visualizations will help you understand the
central limit theorem (<strong>CLT</strong>) and see the effect of
confidence level on accuracy and width of intervals.</p>
<p><strong>We use the following function to conduct the confidence
interval experiments:</strong></p>
<p>The <code>conf_int</code> function takes in the sample mean
(<code>x_bar</code>), S.D. of the population (<code>sd</code>), sample
size (<code>n</code>), and the confidence level
(<code>conf_level</code>), and it outputs the (lower bound, upper bound)
of the calculated confidence interval.</p>
<p>The confidence interval is calculated using this formula <span
class="math inline">\(\bar{X} \pm Z_{\alpha/2} \times
\frac{\sigma}{\sqrt{n}}\)</span> where <span
class="math inline">\(\bar{X}\)</span> is the sample mean, <span
class="math inline">\(\sigma\)</span> is the population standard
deviation, <span class="math inline">\(n\)</span> is the sample size,
and <span class="math inline">\(Z_{\alpha/2}\)</span> is the critical
value. The <span class="math inline">\(\alpha\)</span> is <span
class="math inline">\((100\% - confidence~level) / 2\)</span>. We can
calculate the <span class="math inline">\(Z_{\alpha/2}\)</span> using
the <code>qnorm((1 - confidence level) / 2, lower.tail=FALSE)</code>
function which gives us the quantile value <span
class="math inline">\(q\)</span> of a normal distribution <span
class="math inline">\(Z\)</span> where <span class="math inline">\(P(Z
\geq q) = (1 - confidence\ level) / 2\)</span>.</p>
<p>The <code>experiment</code> function will do repeated sampling from
the normal distribution and compute the confidence interval from each
sampling experiment. The function takes in the mean (<code>avg</code>)
and standard deviation (<code>pop_std</code>) of the normal
distribution, the number of the repeated experiments
(<code>num_exp</code>), the number of samples to use
(<code>num_sample</code>), and confidence level
(<code>confidence_level</code>). The function will return all calculated
confidence intervals in a matrix in which the first column is lower
bound and the second column is upper bound. The
<code>confidence_level</code> argument can be a single value or a vector
of confidence level.</p>
<p>The <code>create_ci_plot</code> function takes in a data frame of n
repeated experiments with calculated confidence intervals. The function
will return a confidence interval plot where the sample means of each
experiment are plotted in a scatter plot and the associated confidence
intervals are plotted as error bars. The colors of the point and error
bar represent if the confidence interval covers the population mean. The
function also requires the <code>population</code>,
<code>plot_title</code>, <code>ymin</code>, <code>ymax</code>, and
<code>ytitle</code> as input arguments.</p>
<p>The <code>create_dis_plot</code> function takes a data frame of n
repeated experiments with whether their calculated interval covers the
true mean. The function will return a density plot of sample means. The
portion of sample means from the experiments that cover the true mean
with its confidence interval will be marked in green. The portion of
sample means from the experiments that miss the true mean will be marked
in red.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Function for calculating the confidence interval</span>
<span class='co'># The function returns a vector of </span>
<span class='co'># (lower CI bound, upper CI bound)</span>
<span class='va'>conf_int</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x_bar</span>, <span class='va'>sd</span>, <span class='va'>n</span>, <span class='va'>conf_level</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>z_crit</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>conf_level</span><span class='op'>)</span><span class='op'>/</span><span class='fl'>2</span>, lower.tail <span class='op'>=</span> <span class='cn'>F</span><span class='op'>)</span>
  <span class='va'>ME</span> <span class='op'>&lt;-</span> <span class='va'>z_crit</span><span class='op'>*</span><span class='va'>sd</span><span class='op'>/</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>n</span><span class='op'>)</span>
  <span class='va'>CI</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>x_bar</span><span class='op'>-</span><span class='va'>ME</span>, <span class='va'>x_bar</span><span class='op'>+</span><span class='va'>ME</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>CI</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Function for doing repeated sampling experiments</span>
<span class='co'># The function returns a matrix of confidence intervals</span>
<span class='co'># calculated from each experiment</span>
<span class='va'>experiment</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>avg</span>, <span class='va'>pop_std</span>, <span class='va'>num_exp</span>, <span class='va'>num_sample</span>, <span class='va'>confidence_level</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>lb</span> <span class='op'>=</span> <span class='cn'>NULL</span>
  <span class='va'>ub</span> <span class='op'>=</span> <span class='cn'>NULL</span>
  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='va'>num_exp</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>samp</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='va'>num_sample</span>, <span class='va'>avg</span>, <span class='va'>pop_std</span><span class='op'>)</span> 
    <span class='va'>sample_mean</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>samp</span><span class='op'>)</span>
    <span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>confidence_level</span><span class='op'>)</span> <span class='op'>&gt;</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>{</span>
      <span class='kw'>for</span> <span class='op'>(</span><span class='va'>j</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>confidence_level</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
        <span class='va'>res</span> <span class='op'>=</span> <span class='fu'>conf_int</span><span class='op'>(</span><span class='va'>sample_mean</span>, <span class='va'>pop_std</span>, <span class='va'>num_sample</span>, <span class='va'>confidence_level</span><span class='op'>[</span><span class='va'>j</span><span class='op'>]</span><span class='op'>)</span>
        <span class='va'>lb</span><span class='op'>[</span><span class='va'>i</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>num_exp</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>res</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
        <span class='va'>ub</span><span class='op'>[</span><span class='va'>i</span> <span class='op'>+</span> <span class='op'>(</span><span class='va'>j</span> <span class='op'>-</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>*</span> <span class='va'>num_exp</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>res</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
      <span class='op'>}</span>
    <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
      <span class='va'>res</span> <span class='op'>=</span> <span class='fu'>conf_int</span><span class='op'>(</span><span class='va'>sample_mean</span>, <span class='va'>pop_std</span>, <span class='va'>num_sample</span>, <span class='va'>confidence_level</span><span class='op'>)</span>
      <span class='va'>lb</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>res</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
      <span class='va'>ub</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='va'>res</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
    <span class='op'>}</span>
  <span class='op'>}</span>
  <span class='va'>CI.mat</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>lb</span>, <span class='va'>ub</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>CI.mat</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Function for creating a confidence interval plot</span>
<span class='co'># The function returns a scatter plot of sample mean</span>
<span class='co'># with their confidence interval plotted as an error bar</span>
<span class='co'># around each dot</span>
<span class='va'>create_ci_plot</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>pop_mean</span>, <span class='va'>plot_title</span>, <span class='va'>ymin</span>, <span class='va'>ymax</span>, <span class='va'>ytitle</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>nth_exp</span>, y<span class='op'>=</span><span class='va'>sample_mean</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>color<span class='op'>=</span><span class='va'>if_success</span>, 
                     alpha<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>sample_mean</span><span class='op'>-</span><span class='va'>pop_mean</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>ymin<span class='op'>=</span><span class='va'>lb</span>, ymax<span class='op'>=</span><span class='va'>ub</span>, color<span class='op'>=</span><span class='va'>if_success</span>,
                        alpha<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='va'>sample_mean</span><span class='op'>-</span><span class='va'>pop_mean</span><span class='op'>)</span><span class='op'>^</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>, 
                    width<span class='op'>=</span><span class='fl'>1.2</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>nth_exp</span>, y<span class='op'>=</span><span class='va'>pop_mean</span>, color<span class='op'>=</span><span class='st'>"True Mean"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Nth Experiment"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='va'>ytitle</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='va'>ymin</span>, <span class='va'>ymax</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='va'>plot_title</span>,
           color <span class='op'>=</span> <span class='st'>"Whether Covers\nTrue Mean"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>axis.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>angle <span class='op'>=</span> <span class='fl'>45</span>, hjust<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#57E119"</span>, <span class='st'>"#F25B4F"</span>, <span class='st'>"#56B4E9"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Function for creating a sampling distribution plot</span>
<span class='co'># The function will return a density plot of sample mean</span>
<span class='co'># from all experiments. The sample means will be marked in</span>
<span class='co'># red if their corresponding confidence intervals fail to</span>
<span class='co'># capture the true mean.</span>
<span class='co'># The sample means of which the confidence intervals capture</span>
<span class='co'># the true mean will be marked in green.</span>
<span class='va'>create_dis_plot</span> <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>plot_title</span>, <span class='va'>rate_vec</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>df</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sample_mean</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>sample_mean</span>, 
                        fill<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Captured"</span>, 
                                   <span class='va'>rate_vec</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>,
                    alpha<span class='op'>=</span><span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>alpha<span class='op'>=</span><span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title <span class='op'>=</span> <span class='va'>plot_title</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Sample Mean"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"#57E119"</span>, <span class='st'>"#F25B4F"</span><span class='op'>)</span><span class='op'>)</span>
  
  <span class='va'>d</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot_build.html'>ggplot_build</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span><span class='op'>$</span><span class='va'>data</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
  
  <span class='va'>lower_bound</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>sample_mean</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>sample_mean</span> <span class='op'>&lt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span> 
                                        <span class='va'>df</span><span class='op'>$</span><span class='va'>if_success</span><span class='op'>==</span><span class='st'>"Missed"</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>upper_bound</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>sample_mean</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>sample_mean</span> <span class='op'>&gt;</span> <span class='fl'>0</span> <span class='op'>&amp;</span> 
                                        <span class='va'>df</span><span class='op'>$</span><span class='va'>if_success</span><span class='op'>==</span><span class='st'>"Missed"</span><span class='op'>]</span><span class='op'>)</span>
  <span class='va'>p</span> <span class='op'>&lt;-</span> <span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>x</span> <span class='op'>&gt;</span> <span class='va'>upper_bound</span><span class='op'>)</span>, 
                     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>, y<span class='op'>=</span><span class='va'>y</span>, fill<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Missed"</span>, <span class='va'>rate_vec</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_ribbon.html'>geom_area</a></span><span class='op'>(</span>data <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>d</span>, <span class='va'>x</span> <span class='op'>&lt;</span> <span class='va'>lower_bound</span><span class='op'>)</span>, 
                     <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>x</span>, y<span class='op'>=</span><span class='va'>y</span>, fill<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Missed"</span>, <span class='va'>rate_vec</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>"Experiments"</span><span class='op'>)</span> <span class='op'>+</span>
       <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Density"</span><span class='op'>)</span>
  
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
<span class='op'>}</span>    
</code></pre>
</div>
</div>
<p>In this example, we sample from a normal distribution with mean of 0
and standard deviation of 1, <span class="math inline">\(Z \sim
\mathcal{N}\left(0, \ 1\right)\)</span>. We conduct the sampling with
size <span class="math inline">\(n=50\)</span> for 10000 times. We
expect the resulting sampling distribution will have a mean of 0 and
standard deviation of <span class="math inline">\(\frac{1}{\sqrt(50)} =
0.141\)</span>, <span class="math inline">\(\bar{X} \sim
\mathcal{N}\left(0, 0.141\right).\)</span> <span
class="math inline">\(\bar{X}\)</span> is the sample mean.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Using a nor</span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>230</span><span class='op'>)</span>
<span class='va'>num_exp</span> <span class='op'>=</span> <span class='fl'>10000</span>
<span class='va'>num_sample</span> <span class='op'>=</span> <span class='fl'>50</span>
<span class='va'>pop_mean</span> <span class='op'>=</span> <span class='fl'>0</span>
<span class='va'>pop_std</span> <span class='op'>=</span> <span class='fl'>1</span>
<span class='va'>CI.mat</span> <span class='op'>=</span> <span class='fu'>experiment</span><span class='op'>(</span><span class='va'>pop_mean</span>, <span class='va'>pop_std</span>, <span class='va'>num_exp</span>, <span class='va'>num_sample</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.80</span>, <span class='fl'>0.90</span>, <span class='fl'>0.95</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>In the cell below, we check if a confidence interval covers the
population mean, and we create a data frame with 6 variables:</p>
<ul>
<li><code>nth_exp</code>: The index of the experiment</li>
<li><code>sample_mean</code>: The sample mean of each experiment</li>
<li><code>lb</code>: Lower bound of the confidence interval</li>
<li><code>ub</code>: The upper bound of the confidence interval</li>
<li><code>if_success</code>: Whether the interval covers the population
mean</li>
<li><code>confidence_level</code>: The confidence level of the
interval</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>success</span> <span class='op'>=</span> <span class='fl'>0</span>
<span class='va'>if_success</span> <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='kw'>for</span> <span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>CI.mat</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>CI.mat</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;=</span> <span class='va'>pop_mean</span> <span class='op'>&amp;</span>
      <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>pop_mean</span><span class='op'>)</span> <span class='op'>&lt;=</span> <span class='va'>CI.mat</span><span class='op'>[</span><span class='va'>i</span>, <span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='va'>success</span> <span class='op'>=</span> <span class='va'>success</span> <span class='op'>+</span> <span class='fl'>1</span>
    <span class='va'>if_success</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Captured"</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
    <span class='va'>if_success</span><span class='op'>[</span><span class='va'>i</span><span class='op'>]</span> <span class='op'>=</span> <span class='st'>"Missed"</span>
  <span class='op'>}</span>
<span class='op'>}</span>

<span class='va'>level</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"80%"</span>, <span class='va'>num_exp</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"90%"</span>, <span class='va'>num_exp</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"95%"</span>, <span class='va'>num_exp</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>level</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>level</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"80%"</span>, <span class='st'>"90%"</span>, <span class='st'>"95%"</span><span class='op'>)</span>, ordered<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>

<span class='va'>if_success</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>if_success</span><span class='op'>)</span>

<span class='va'>df</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>nth_exp<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>num_exp</span>, rep<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>level</span><span class='op'>)</span><span class='op'>)</span>, 
                sample_mean<span class='op'>=</span><span class='op'>(</span><span class='va'>CI.mat</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>CI.mat</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>/</span> <span class='fl'>2</span>, 
                lb<span class='op'>=</span><span class='va'>CI.mat</span><span class='op'>[</span>, <span class='fl'>1</span><span class='op'>]</span>, ub<span class='op'>=</span><span class='va'>CI.mat</span><span class='op'>[</span>, <span class='fl'>2</span><span class='op'>]</span>,
                if_success<span class='op'>=</span><span class='va'>if_success</span>,
                confidence_level <span class='op'>=</span> <span class='va'>level</span><span class='op'>)</span>


<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Mean of the sample means is"</span>, 
            <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>sample_mean</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Mean of the sample means is -0.002&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Standard deviation of the sample means is"</span>,
            <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>df</span><span class='op'>$</span><span class='va'>sample_mean</span><span class='op'>)</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Standard deviation of the sample means is 0.142&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_95</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>confidence_level</span> <span class='op'>==</span> <span class='st'>"95%"</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Summary for experiments using 95% confidence level"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Summary for experiments using 95% confidence level&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>df_95</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  sample_mean              lb                ub         
 Min.   :-0.495754   Min.   :-0.7729   Min.   :-0.2186  
 1st Qu.:-0.097267   1st Qu.:-0.3744   1st Qu.: 0.1799  
 Median :-0.001391   Median :-0.2786   Median : 0.2758  
 Mean   :-0.002472   Mean   :-0.2797   Mean   : 0.2747  
 3rd Qu.: 0.092745   3rd Qu.:-0.1844   3rd Qu.: 0.3699  
 Max.   : 0.624169   Max.   : 0.3470   Max.   : 0.9013  
    if_success  
 Captured:9482  
 Missed  : 518  
                
                
                
                </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_90</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>confidence_level</span> <span class='op'>==</span> <span class='st'>"90%"</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Summary for experiments using 90% confidence level"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Summary for experiments using 90% confidence level&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>df_90</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  sample_mean              lb                ub         
 Min.   :-0.495754   Min.   :-0.7284   Min.   :-0.2631  
 1st Qu.:-0.097267   1st Qu.:-0.3299   1st Qu.: 0.1354  
 Median :-0.001391   Median :-0.2340   Median : 0.2312  
 Mean   :-0.002472   Mean   :-0.2351   Mean   : 0.2301  
 3rd Qu.: 0.092745   3rd Qu.:-0.1399   3rd Qu.: 0.3254  
 Max.   : 0.624169   Max.   : 0.3916   Max.   : 0.8568  
    if_success  
 Captured:8994  
 Missed  :1006  
                
                
                
                </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_80</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>confidence_level</span> <span class='op'>==</span> <span class='st'>"80%"</span>,<span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Summary for experiments using 80% confidence level"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Summary for experiments using 80% confidence level&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>df_80</span><span class='op'>[</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>3</span>, <span class='fl'>4</span>, <span class='fl'>5</span><span class='op'>)</span><span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>  sample_mean              lb                 ub          
 Min.   :-0.495754   Min.   :-0.67699   Min.   :-0.31451  
 1st Qu.:-0.097267   1st Qu.:-0.27851   1st Qu.: 0.08397  
 Median :-0.001391   Median :-0.18263   Median : 0.17985  
 Mean   :-0.002472   Mean   :-0.18371   Mean   : 0.17877  
 3rd Qu.: 0.092745   3rd Qu.:-0.08849   3rd Qu.: 0.27398  
 Max.   : 0.624169   Max.   : 0.44293   Max.   : 0.80541  
    if_success  
 Captured:7986  
 Missed  :2014  
                
                
                
                </code></pre>
</div>
<p>As the experiments show, the mean of the sample means from the 10000
sampling experiments is 0.002 and the standard deviation is 0.142, which
are close to the theoretical values calculated using CLT.</p>
<p>From the summary, we can also find that the confidence interval (CI)
becomes smaller as we decrease the confidence level. The median lower
and median upper bounds for the CI with a 95% confidence level are
-0.2786 and 0.2758. For the 90% confidence level, the median lower and
upper bounds become -0.2340 and 0.2312. As we decrease the confidence
level to 80%, the median lower and upper bounds are -0.1826 and
0.1799.</p>
<h3
id="distribution-of-lower-and-upper-bounds-of-confidence-intervals">5.1
Distribution of lower and upper bounds of confidence intervals</h3>
<p>Below, we show a density plot of the lower and upper bounds of
intervals with different confidence levels. We can see that the gaps
between the average lower and upper bounds of CI decrease as we decrease
the confidence level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>lb</span>, fill<span class='op'>=</span><span class='va'>confidence_level</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_density.html'>geom_density</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>ub</span>, fill<span class='op'>=</span><span class='va'>confidence_level</span><span class='op'>)</span>, alpha<span class='op'>=</span><span class='fl'>0.6</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Distribution of Lower and Upper Bounds of CI\nfrom 10000 experiments"</span>,
       fill<span class='op'>=</span><span class='st'>"Confidence Level"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<h3
id="the-success-rate-of-intervals-with-different-confidence-levels">5.2
The success rate of intervals with different confidence levels</h3>
<p>The success rate of intervals also decreases as the confidence level
drops. Among 10000 experiments, we missed the true mean by 522 times (5%
of all experiments) using 95% confidence intervals, by 1002 times (10%
of all experiments) using 90% confidence intervals, and by 2015 times
(20% of all experiments) using 80% confidence intervals.</p>
<p>Below is a success rate table:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>"Success rate table:"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Success rate table:&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rate_table</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/proportions.html'>prop.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>level</span>, <span class='va'>if_success</span><span class='op'>)</span>, 
                              margin<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>, 
                   digits <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='va'>rate_table</span>
</code></pre>
</div>
<pre><code>     if_success
level Captured Missed
  80%    0.799  0.201
  90%    0.899  0.101
  95%    0.948  0.052</code></pre>
</div>
<p>The results we get are consistent with the definition of confidence
level. In the long run, an n% confidence interval will capture the true
parameters approximately n% of the time.</p>
<h3 id="confidence-interval">5.3 95% Confidence Interval</h3>
<p>Below we show a density plot of the sample means from 10000
experiments. We marked the portion that captures the true mean with a
95% confidence interval in green, and we paint the portion that misses
the true mean in red.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>create_dis_plot</span><span class='op'>(</span><span class='va'>df_95</span>,
                <span class='st'>"Distribution of Sample Means\nwith 10000 experiments of 50 samples\nfrom a Normal Distribution (mu=0, sd=1)"</span>,
                <span class='va'>rate_table</span><span class='op'>[</span><span class='fl'>3</span>, <span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p>As the plot shows, the distribution of sampling mean has a shape of a
normal distribution with a mean of 0. About 5.2% of the experiments miss
the true mean using the 95% confidence intervals.</p>
<p>To further investigate how confidence level affects the interval’s
success rate (accuracy) and width, we create the following scatter plot
with error bars.</p>
<p>To generate this plot, we <strong>randomly select 100</strong>
experiments. We plot the sample mean of each experiment using a scatter
plot and its 95%, 90%, and 80% confidence intervals using error bars.
The experiments that capture the true mean (blue horizontal line) are
marked in green, and the experiments that miss the true mean are marked
in red.</p>
<p>We fix the scale of the y axis so you can observe how the interval
width decreases as we reduce the confidence levels. You will also find
more misses when the interval width decreases.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>189</span><span class='op'>)</span>
<span class='va'>random_100</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>df_95</span><span class='op'>)</span>, <span class='fl'>100</span><span class='op'>)</span>
<span class='va'>df_95_sub</span> <span class='op'>=</span> <span class='va'>df_95</span><span class='op'>[</span><span class='va'>random_100</span>, <span class='op'>]</span>
<span class='va'>df_95_sub</span><span class='op'>$</span><span class='va'>nth_exp</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>
<span class='va'>missed</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>df_95_sub</span><span class='op'>$</span><span class='va'>if_success</span> <span class='op'>==</span> <span class='st'>"Missed"</span><span class='op'>)</span>
<span class='va'>success</span> <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='va'>missed</span>
<span class='fu'>create_ci_plot</span><span class='op'>(</span><span class='va'>df_95_sub</span>, 
               <span class='fl'>0</span>,
               plot_title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"95% Confidence Interval of 100 Experiments"</span>,
                                  <span class='st'>"\nMissed"</span>, <span class='va'>missed</span>, <span class='st'>", Success"</span>, <span class='va'>success</span><span class='op'>)</span>,
               ytitle <span class='op'>=</span> <span class='st'>"Sample Mean"</span>,
               <span class='fl'>0.7</span>,
               <span class='op'>-</span><span class='fl'>0.7</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>We use the variable opacity (<code>alpha</code>) when plotting the
confidence interval. If the center of a confidence interval is farther
from the population mean, the confidence interval will have a higher
opacity (<code>alpha</code>). This will help us highlight the
experiments in which the confidence interval will miss the true mean if
we further decrease the confidence level.</p>
<h3 id="confidence-interval-1">5.4 90% Confidence Interval</h3>
<p>What will happen if we drop the confidence level from 95% to 90%?</p>
<p>As shown in the sampling distribution plot below, a 90% confidence
interval will have a lower success rate of capturing the population
mean. About 10% of the experiments fail to capture the true mean.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_90</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>confidence_level</span> <span class='op'>==</span> <span class='st'>"90%"</span>,<span class='op'>]</span>

<span class='fu'>create_dis_plot</span><span class='op'>(</span><span class='va'>df_90</span>, 
                <span class='st'>"Distribution of Sample Means\nwith 10000 experiments of 50 samples\nfrom a Normal Distribution (mu=0, sd=1)"</span>,
                <span class='va'>rate_table</span><span class='op'>[</span><span class='fl'>2</span>, <span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-10-1.png" width="624" /></p>
</div>
<p>The accuracy drops because the confidence interval is shrinking.
Eight more experiments that previously captured the true mean with 95%
confidence intervals now miss it because the width of their interval
shrinks.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_90_sub</span> <span class='op'>=</span> <span class='va'>df_90</span><span class='op'>[</span><span class='va'>random_100</span>, <span class='op'>]</span>
<span class='va'>df_90_sub</span><span class='op'>$</span><span class='va'>nth_exp</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>
<span class='va'>missed</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>df_90_sub</span><span class='op'>$</span><span class='va'>if_success</span> <span class='op'>==</span> <span class='st'>"Missed"</span><span class='op'>)</span>
<span class='va'>success</span> <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='va'>missed</span>
<span class='fu'>create_ci_plot</span><span class='op'>(</span><span class='va'>df_90_sub</span>, 
               <span class='fl'>0</span>,
               plot_title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"90% Confidence Interval of 100 Experiments"</span>,
                                  <span class='st'>"\nMissed"</span>, <span class='va'>missed</span>, <span class='st'>", Success"</span>, <span class='va'>success</span><span class='op'>)</span>,
               ytitle <span class='op'>=</span> <span class='st'>"Sample Mean"</span>,
               <span class='fl'>0.7</span>,
               <span class='op'>-</span><span class='fl'>0.7</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-11-1.png" width="624" /></p>
</div>
<h3 id="confidence-interval-2">5.5 80% Confidence Interval</h3>
<p>As we keep decreasing the confidence level, about 2000 out of 10000
experiments now miss the true mean with their 80% confidence
interval.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_80</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>df</span><span class='op'>$</span><span class='va'>confidence_level</span> <span class='op'>==</span> <span class='st'>"80%"</span>,<span class='op'>]</span>

<span class='fu'>create_dis_plot</span><span class='op'>(</span><span class='va'>df_80</span>, 
                <span class='st'>"Distribution of Sample Means\nwith 10000 experiments of 50 samples\nfrom a Normal Distribution (mu=0, sd=1)"</span>, 
                <span class='va'>rate_table</span><span class='op'>[</span><span class='fl'>1</span>, <span class='op'>]</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>The width of the confidence interval also decreases. For the same 100
randomly selected experiments, 19 of them miss the true mean as their
interval width shrinks.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>df_80_sub</span> <span class='op'>=</span> <span class='va'>df_80</span><span class='op'>[</span><span class='va'>random_100</span>, <span class='op'>]</span>
<span class='va'>df_80_sub</span><span class='op'>$</span><span class='va'>nth_exp</span> <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>100</span>
<span class='va'>missed</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>df_80_sub</span><span class='op'>$</span><span class='va'>if_success</span> <span class='op'>==</span> <span class='st'>"Missed"</span><span class='op'>)</span>
<span class='va'>success</span> <span class='op'>=</span> <span class='fl'>100</span> <span class='op'>-</span> <span class='va'>missed</span>
<span class='fu'>create_ci_plot</span><span class='op'>(</span><span class='va'>df_80_sub</span>, 
               <span class='fl'>0</span>,
               plot_title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"80% Confidence Interval of 100 Experiments"</span>,
                                  <span class='st'>"\nMissed"</span>, <span class='va'>missed</span>, <span class='st'>", Success"</span>, <span class='va'>success</span><span class='op'>)</span>,
               ytitle <span class='op'>=</span> <span class='st'>"Sample Mean"</span>,
               <span class='fl'>0.7</span>,
               <span class='op'>-</span><span class='fl'>0.7</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-13-1.png" width="624" /></p>
</div>
<h3 id="confidence-levels-effect-on-interval-width">5.6 Confidence
Level’s Effect on Interval Width</h3>
<p>Let’s look closely at the confidence level’s effect on interval
width. We randomly select 6 experiments and plot their 95%, 90%, and 80%
confidence intervals in pastel purple, pastel yellow, and mint brackets
respectively. We scale the widths of brackets based on their confidence
levels so you can directly observe their difference even if they are
overlaid.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>random_exp</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='va'>num_exp</span>, <span class='fl'>6</span><span class='op'>)</span>
<span class='va'>random_exp</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>random_exp</span>, 
               <span class='va'>random_exp</span> <span class='op'>+</span> <span class='va'>num_exp</span>,
               <span class='va'>random_exp</span> <span class='op'>+</span> <span class='fl'>2</span> <span class='op'>*</span> <span class='va'>num_exp</span><span class='op'>)</span>
<span class='va'>df_sub</span> <span class='op'>=</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>random_exp</span>,<span class='op'>]</span>
<span class='va'>df_sub</span> <span class='op'>=</span> <span class='va'>df_sub</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='va'>df_sub</span><span class='op'>)</span><span class='op'>:</span><span class='fl'>1</span>,<span class='op'>]</span>
<span class='va'>df_sub</span><span class='op'>$</span><span class='va'>nth_exp</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>6</span>, times<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span>

<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>df_sub</span>, <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>nth_exp</span>, x<span class='op'>=</span><span class='va'>sample_mean</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>xmin<span class='op'>=</span><span class='va'>lb</span>, xmax<span class='op'>=</span><span class='va'>ub</span>, 
                        color<span class='op'>=</span><span class='va'>confidence_level</span>,
                        size<span class='op'>=</span><span class='va'>confidence_level</span><span class='op'>)</span>, 
                    width<span class='op'>=</span><span class='fl'>0.5</span>, alpha<span class='op'>=</span><span class='fl'>0.9</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_line</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>y<span class='op'>=</span><span class='va'>nth_exp</span>, x<span class='op'>=</span><span class='va'>pop_mean</span>, 
                    color<span class='op'>=</span><span class='st'>"True Mean"</span><span class='op'>)</span>,
                size<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Sample Mean"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Nth Experiment"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>"Confidence Level's Effect on\nInterval Width"</span>,
           color <span class='op'>=</span> <span class='st'>"Confidence Level"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/guides.html'>guides</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='st'>"none"</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_size_manual</a></span><span class='op'>(</span>values<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_brewer.html'>scale_color_brewer</a></span><span class='op'>(</span>palette <span class='op'>=</span> <span class='st'>"Set3"</span><span class='op'>)</span>
<span class='va'>p</span> <span class='op'>+</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>group<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span><span class='op'>(</span><span class='va'>confidence_level</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<img src="a_files/figure-html5/unnamed-chunk-14-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"df_sub.png"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We can observe that the width of the interval increases as the
confidence level becomes higher. This is expected because a wider width
interval will have a higher frequency of covering the true parameter in
the long run. As we learned from the previous scatter plots of 100
experiments, more experiments missed the true mean when their confidence
intervals became narrower.</p>
<h2 id="future-work">6. Future Work</h2>
<p>We will turn the visualizations of the sampling distributions and
confidence intervals plots (sec 5.3) into interactive applications in
the next stage of this project.</p>
<p>Below are a few sketches of our application designs:</p>
<figure>
<img src="image1.jpg" alt="Application Design" />
<figcaption aria-hidden="true">Application Design</figcaption>
</figure>
<p>Confidence Interval Plots: Our design of the interactive confidence
interval plots is in the upper part of our sketch. For this
visualization, we will have a slide bar to allow users to adjust the
confidence level and see how it affects the interval width (shrinking or
enlarging) and the success rate (more or fewer intervals cover the true
mean).</p>
<p>Sampling Distribution Plots: Our design of the sampling distribution
plots is in the lower part of our sketch. For this visualization, we
will have two slide bars (or input boxes) for users to adjust the sample
size, <span class="math inline">\(n\)</span>, and population standard
deviation, <span class="math inline">\(\sigma\)</span>. This will help
users to visualize how <span class="math inline">\(n\)</span> and <span
class="math inline">\(\sigma\)</span> affect the shape of a sampling
distribution as illustrated in the central limit theorem. We will also
have a slide bar for the confidence level. The proportion of the sample
means of which the associated intervals to capture the true parameter
will be shaded in red. As users adjust the confidence level, they will
observe how the red area shrinks or enlarges proportionally with the new
confidence level.</p>
<h2 id="real-life-usage-examples">7. Real Life Usage &amp; Examples</h2>
<p>Remember that confidence intervals are used to give a range as an
estimate for an unknown population parameter, which is often the mean or
the standard deviation. In real life, confidence intervals are used a
lot when we try to gain insight into properties, like the mean and the
SD, about the population in a cost-efficient way or when taking a census
(sampling every individual in the population) isn’t possible.</p>
<p>Example 1: Biology Confidence intervals are often used in biology to
estimate the mean height, weight, width, diameter, etc. of different
plant and animal species. For example, a biologist may be interested in
measuring the mean weight of a certain species of frog in Australia.
Since it would take too long to go around and weigh thousands of
individual frogs, the biologist may instead collect a simple random
sample of 50 frogs and measure the mean and standard deviation of the
frogs in the sample. She could then use the sample mean and sample
standard deviation to construct an interval for the true mean of the
frogs in the entire population.</p>
<p>Example 2: Clinical Trials Confidence intervals are often used in
clinical trials to determine the mean change in blood pressure, heart
rate, cholesterol, etc. produced by some new drug or treatment. For
example, a doctor may believe that a new drug is able to reduce blood
pressure in patients. To test this, he may recruit 20 patients to
participate in a trial in which they used the new drug for one month. At
the end of the month, the doctor may record the mean decrease in blood
pressure and the standard deviation of the decrease in each patient in
the sample. 15 Students Weekday Sleep (hours) 0 25 50 75 100 He could
then use the sample mean and sample standard deviation to construct an
interval for the true mean change in blood pressure that patients are
likely to experience in the population.</p>
<p>Example 3: Polling Confidence intervals are used in polling to gauge
voter support for laws or taxes at the local, state, or national level.
Let’s say we want to find the percentage of city voters that support a
property tax increase to build a new police station. To save time, we
can poll a small group of citizens (rather than the entire city’s
population) and find a confidence interval. Using a 95% confidence
interval, we might find a range of (62%, 68%). This can tell us that,
with 95% confidence, a majority (more than 50%) of the city’s voters
support certain policies.</p>
<p>References:<br />
<a
href="https://www.statology.org/confidence-interval-real-life-example/">https://www.statology.org/confidence-interval-real-life-example/</a><br />
<a
href="https://www.statology.org/confidence-interval-real-life-example/">https://www.quora.com/Where-
are-confidence-intervals-used-in-real-life</a></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='co'># Inter-arival Time Dist - Exp(rate=.50286)</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>stat_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='va'>dexp</span>,
                args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>rate <span class='op'>=</span> <span class='fl'>.50286</span><span class='op'>)</span>,
                geom <span class='op'>=</span> <span class='st'>"area"</span>,
                fill<span class='op'>=</span><span class='st'>"#345beb"</span>, alpha<span class='op'>=</span><span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Theoritical Probability Distribution Function of \n Exponential With Rate=0.50286"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Probability"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"x"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="a_files/figure-html5/unnamed-chunk-15-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"expo_dist.png"</span><span class='op'>)</span>

<span class='va'>dgamma2</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>shape</span>, <span class='va'>scale</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>dgamma</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>-</span><span class='fl'>0.1</span>, shape<span class='op'>=</span><span class='va'>shape</span>, scale<span class='op'>=</span><span class='va'>scale</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Service Time Dist</span>

<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_function.html'>stat_function</a></span><span class='op'>(</span>fun <span class='op'>=</span> <span class='va'>dgamma2</span>,
                args <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>2.3</span>, scale<span class='op'>=</span><span class='fl'>.1</span><span class='op'>)</span>,
                geom <span class='op'>=</span> <span class='st'>"area"</span>,
                fill<span class='op'>=</span><span class='st'>"#345beb"</span>, alpha<span class='op'>=</span><span class='fl'>0.7</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>"Therotical Probability Distribution Function of Gamma with\n Offset=0.1, Shape=2.3, Scale=0.1"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"x"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Probability"</span><span class='op'>)</span>
</code></pre>
</div>
<img src="a_files/figure-html5/unnamed-chunk-15-2.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggsave.html'>ggsave</a></span><span class='op'>(</span><span class='st'>"gamma_dist.png"</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/graphics/curve.html'>curve</a></span><span class='op'>(</span><span class='fu'>dgamma2</span><span class='op'>(</span><span class='va'>x</span><span class='op'>-</span><span class='fl'>0.1</span>, shape <span class='op'>=</span> <span class='fl'>2.3</span>, scale<span class='op'>=</span><span class='fl'>.1</span><span class='op'>)</span>, from<span class='op'>=</span><span class='fl'>0</span>, to<span class='op'>=</span><span class='fl'>1</span>, col<span class='op'>=</span><span class='st'>'blue'</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="a_files/figure-html5/unnamed-chunk-15-3.png" width="624" /></p>
</div>
<div class="sourceCode" id="cb11"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
